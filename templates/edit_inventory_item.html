{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Edit Inventory Item – JS IT Computer Trading</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap" rel="stylesheet">

  <!-- Bootstrap & FontAwesome from CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    body {
      background: #f8f9fa;
      font-family: 'Montserrat', sans-serif;
    }
    .navbar {
      margin-bottom: 2rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .form-container {
      background: white;
      border-radius: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }
    .form-label {
      font-weight: 600;
      color: #495057;
    }
    .btn-back {
      background: #6c757d;
      border: none;
      border-radius: 25px;
      padding: 0.75rem 2rem;
      font-weight: 600;
    }
    .btn-submit {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 25px;
      padding: 0.75rem 2rem;
      font-weight: 600;
    }
    .image-preview {
      max-width: 200px;
      max-height: 200px;
      border-radius: 10px;
      border: 2px dashed #dee2e6;
      padding: 1rem;
      text-align: center;
    }
    .current-image {
      max-width: 200px;
      max-height: 200px;
      border-radius: 10px;
      border: 2px solid #dee2e6;
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar navbar-expand bg-white shadow-sm">
    <div class="container">
      <a class="navbar-brand" href="{% url 'dashboard' %}">
        <img src="{% static 'images/JS_LOGO.jpg' %}" alt="Logo" width="40" class="d-inline-block align-text-top">
        JS IT Computer Trading
      </a>
      <div class="ms-auto">
        <span class="me-3">Hello, {{ request.user.username }}</span>
        <a href="{% url 'logout' %}" class="btn btn-outline-secondary btn-sm">Logout</a>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="form-container">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="mb-0">
          <i class="fas fa-edit me-2"></i>Edit Inventory Item
        </h3>
        <a href="{% url 'dashboard' %}" class="btn btn-back text-white">
          <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
        </a>
      </div>

      <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="row">
          <!-- Basic Information -->
          <div class="col-md-6">
            <h5 class="mb-3 text-primary">Basic Information</h5>
            
            <div class="mb-3">
              <label for="item_name" class="form-label">Item Name *</label>
              <input type="text" class="form-control" id="item_name" name="item_name" value="{{ item.item_name }}" required>
            </div>
            
            <div class="mb-3">
              <label for="brand" class="form-label">Brand *</label>
              <input type="text" class="form-control" id="brand" name="brand" value="{{ item.brand }}" required>
            </div>
            
            <div class="mb-3">
              <label for="model" class="form-label">Model *</label>
              <input type="text" class="form-control" id="model" name="model" value="{{ item.model }}" required>
            </div>
            
            <div class="mb-3">
              <label for="description" class="form-label">Description</label>
              <textarea class="form-control" id="description" name="description" rows="3" placeholder="Enter item description...">{{ item.description }}</textarea>
            </div>
          </div>
          
          <!-- Pricing & Inventory -->
          <div class="col-md-6">
            <h5 class="mb-3 text-primary">Pricing & Inventory</h5>
            
            <div class="mb-3">
              <label for="unit_cost" class="form-label">Unit Cost (₱) *</label>
              <input type="number" class="form-control" id="unit_cost" name="unit_cost" step="0.01" min="0" value="{{ item.unit_cost }}" required>
            </div>
            
            <div class="mb-3">
              <label for="srp_price" class="form-label">SRP Price (₱) *</label>
              <input type="number" class="form-control" id="srp_price" name="srp_price" step="0.01" min="0" value="{{ item.srp_price }}" required>
            </div>
            
            <div class="mb-3">
              <label for="quantity" class="form-label">Quantity *</label>
              <input type="number" class="form-control" id="quantity" name="quantity" min="0" value="{{ item.quantity }}" required>
            </div>
            
            <div class="mb-3">
              <label for="serial_number" class="form-label">Serial Number</label>
              <input type="text" class="form-control" id="serial_number" name="serial_number" value="{{ item.serial_number|default:'' }}" placeholder="Optional">
            </div>
          </div>
        </div>
        
        <!-- Image Upload -->
        <div class="row mt-4">
          <div class="col-12">
            <h5 class="mb-3 text-primary">Item Image</h5>
            <div class="row align-items-center">
              <div class="col-md-6">
                <div class="mb-3">
                  <label for="item_picture" class="form-label">Upload New Image</label>
                  <input type="file" class="form-control" id="item_picture" name="item_picture" accept="image/*" onchange="previewImage(this)">
                  <small class="text-muted">Leave empty to keep current image</small>
                </div>
              </div>
              <div class="col-md-6">
                {% if item.item_picture %}
                  <div class="mb-3">
                    <label class="form-label">Current Image</label>
                    <div>
                      <img src="{{ item.item_picture.url }}" alt="Current image" class="current-image">
                    </div>
                  </div>
                {% endif %}
                <div id="imagePreview" class="image-preview d-none">
                  <label class="form-label">New Image Preview</label>
                  <img id="previewImg" src="" alt="Preview" class="img-fluid">
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Item Statistics -->
        <div class="row mt-4">
          <div class="col-12">
            <h5 class="mb-3 text-primary">Item Statistics</h5>
            <div class="row">
              <div class="col-md-3">
                <div class="card bg-light">
                  <div class="card-body text-center">
                    <h6 class="card-title">Total Value</h6>
                    <p class="card-text text-primary fw-bold">₱{{ item.total_value|floatformat:2 }}</p>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="card bg-light">
                  <div class="card-body text-center">
                    <h6 class="card-title">Profit Margin</h6>
                    <p class="card-text text-success fw-bold">{{ item.profit_margin|floatformat:1 }}%</p>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="card bg-light">
                  <div class="card-body text-center">
                    <h6 class="card-title">Stock Status</h6>
                    <span class="badge 
                      {% if item.stock_status == 'In Stock' %}bg-success
                      {% elif item.stock_status == 'Low Stock' %}bg-warning
                      {% else %}bg-danger{% endif %}">
                      {{ item.stock_status }}
                    </span>
                  </div>
                </div>
              </div>
              <div class="col-md-3">
                <div class="card bg-light">
                  <div class="card-body text-center">
                    <h6 class="card-title">Date Added</h6>
                    <p class="card-text text-muted">{{ item.date_added|date:"M d, Y" }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Submit Buttons -->
        <div class="row mt-4">
          <div class="col-12 text-center">
            <button type="submit" class="btn btn-submit text-white me-3">
              <i class="fas fa-save me-2"></i>Update Item
            </button>
            <a href="{% url 'dashboard' %}" class="btn btn-outline-secondary">
              <i class="fas fa-times me-2"></i>Cancel
            </a>
          </div>
        </div>
      </form>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    function previewImage(input) {
      const preview = document.getElementById('imagePreview');
      const previewImg = document.getElementById('previewImg');
      
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        
        reader.onload = function(e) {
          previewImg.src = e.target.result;
          preview.classList.remove('d-none');
        }
        
        reader.readAsDataURL(input.files[0]);
      } else {
        preview.classList.add('d-none');
      }
    }
  </script>
</body>
</html> 